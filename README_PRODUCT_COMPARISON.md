# 商品智能比較功能使用說明

## 功能特色

✨ **使用 Google Gemini 2.0 Flash 最新 AI 模型**
- 高精度商品名稱和規格比對
- 智能識別相同商品的不同包裝或版本
- 支援繁體中文商品分析

🎯 **精準比較標準**
- 型號完全一致：相似度 95-100%
- 品牌規格一致：相似度 85-94%  
- 高度相似商品：相似度 80-89%
- 只顯示相似度 80% 以上的高品質匹配

📊 **完整價格分析**
- 多平台價格比較
- 即時價差計算
- 最佳優惠推薦

## 安裝步驟

### 1. 安裝依賴套件
```bash
pip install -r requirements.txt
```

### 2. 設定 Gemini API Key

1. 前往 [Google AI Studio](https://aistudio.google.com/app/apikey) 申請免費 API Key
2. 複製 `.env.example` 為 `.env`
3. 在 `.env` 檔案中設定您的 API Key：

```bash
# 複製範例檔案
cp .env.example .env

# 編輯 .env 檔案
GEMINI_API_KEY=your_actual_api_key_here
```

### 3. 啟動應用程式
```bash
python web_app.py
```

## 使用方式

### 1. 開啟商品比較
- 在商品詳細頁面，點擊商品卡片上的 📈 圖示
- 或在列表視圖中點擊操作欄的比較按鈕

### 2. 查看比較結果
系統會自動：
- 🔍 分析所有爬蟲資料中的候選商品
- 🤖 使用 AI 進行智能比對
- 📊 依相似度分組顯示結果
- 💰 計算價格差異和優惠資訊

### 3. 結果說明
- **完全相同**：型號品牌完全一致 (≥95%)
- **高度相似**：主要規格相同 (85-94%)
- **相似商品**：功能相近 (80-89%)

## 技術特色

### AI 模型優勢
- **Gemini 2.0 Flash**：Google 最新語言模型
- **批次處理**：支援大量商品同時比較
- **智能過濾**：自動排除不相關商品

### 資料來源
- 自動讀取 `crawl_data/` 資料夾中的所有爬蟲結果
- 支援多種檔案格式和平台資料
- 即時更新比較結果

### 效能優化
- 關鍵字預篩選減少 API 呼叫
- 批次處理避免超時
- 結果快取提升體驗

## 疑難排解

### API Key 問題
```
Warning: Gemini API key not found. Product comparison feature will be disabled.
```
**解決方法**：確認 `.env` 檔案中的 `GEMINI_API_KEY` 設定正確

### 沒有比較結果
可能原因：
1. 資料庫中沒有相似商品
2. 相似度低於 80% 門檻
3. 商品名稱差異過大

### 功能暫時無法使用
```json
{
  "error": "Gemini API 未配置，無法使用商品比較功能"
}
```
**解決方法**：
1. 檢查網路連線
2. 確認 API Key 有效
3. 檢查是否超出 API 使用限制

## API 限制說明

### Google Gemini API 限制
- **免費版**：每分鐘 15 次請求
- **付費版**：依方案而定
- **建議**：合理使用避免超出限制

### 最佳實踐
- 不要頻繁點擊比較按鈕
- 系統已自動批次處理減少 API 呼叫
- 大量商品會自動分批處理

## 更新紀錄

- ✅ 整合 Gemini 2.0 Flash 模型
- ✅ 支援繁體中文商品比較
- ✅ 多平台價格分析
- ✅ 響應式設計支援手機
- ✅ 批次處理提升效能
